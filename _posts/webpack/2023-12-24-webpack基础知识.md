---
title: webpack基础知识
date: 2023-12-24 19:33:00 +0800
categories: [webapck]
tags: [webapck]
description: webpack基础知识,webpack配置。
---

## webpack4与webpack5的区别

- package.json 的 dev-server 命令改了`"dev": "webpack serve --config build/webpack.dev.js"`
- 升级新版本`const { merge } = require( 'webpack-merge')`
- 升级新版本`const [ CleanWebpackPlugin } = require('clean-webpack-plugin')`
- `module.rules`中`loader: ['xxx-loader']`  换成`use: ['xxx-loader']`
- `filename:'bundle,[contenthash:8].js'`其中` h'`小写，不能大写

## 入口(entry)

- SPA单文件入口
```js
const path = require('path')
const { srcPath, distPath } = require('./paths')
module.exprots = {
    entry: path.join('srcPath', 'index.js'), 
    output: {
        filename: 'bundle.[contentHash:8].js'   // 打包代码是，加上hash戳，文件没有变化是hash不会变
    }
}
```
- 多页面入口
```js
const path = require('path')
const { srcPath, distPath } = require('./paths')
module.exprots = {
    entry: {
        index: path.join('srcPath', 'index.js')
        other: path.joni('srcPath', 'other.js')
    },
    output: {
        filename: '[name].[contentHash:8].js'   // name 即多入口是 entry的名字不重复
    },
    plugins: [
        // 多入口生成 index.html
        new HtmlWebpackPlugin({
            template: path.join('srcPath', 'index.html'),
            filename: 'index.html',
            // chunks 表示引入哪些chunk
            chunks: ['index']   // 只引用index.js
        }),

        // 多入口生成 other.html
        new HtmlWebpackPlugin({
            template: path.join('srcPath', 'other.html'),
            filename: 'other.html'
            // chunks 表示引入哪些chunk
            chunks: ['other']   // 只引用other.js
        })
    ]
}
```

## loader
- loader 的执行顺序是：从后到前
```js
module.exprots = {
    module: {
        rules: [
            {
                test: /\.css$/,
                // 执行顺序是从后到前的方式 ‘postcss-loader’是追加前缀
                loader: ['style-loader', 'css-loader', 'postcss-loader']
            }
        ]
    }
}

```


## plugin



## webapck性能优化
webpack 性能优化-产生代码：
- 小图片 base64 编码
- bundle 加 hash
- 懒加载
- 提取公共代码
- 使用CDN加速
- IgorePlugin
- 使用product
- Scope Hosting


## 为何要打包构建
- 体积小（Tree-Shaking、压缩、合并），加载速度快
- 编译高级语言或语法（TS、ES6+、模块化、less/scss）
- 兼容性和错误检查（Polyfill、postcss、eslint）
- 统一、高效的开发环境
- 统一的构建流程和产出标准
- 集成公司构建规范（提测、上线）
 

## module/chunk/bundle的区别
 - module - 各个与源码文件，webapck中一切皆为模块
 - chunk - 多模块合并成的，如entry、import()、splitChunk
 - bundle - 产生最终的文件


## loader和plugin的区别
 - loader模块转换，如less->css、ES6+ ->ES5、自定义loader功能处理
 - plugin 扩展插件、如HtmlWebpackPlugin
